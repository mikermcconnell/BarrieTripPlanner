# Copy this file to .env and add your actual API keys

# LocationIQ API key for backend/dev proxy only (never embed in public client builds)
# Get your key at: https://locationiq.com/
LOCATIONIQ_API_KEY=YOUR_LOCATIONIQ_API_KEY_HERE

# API Proxy URL â€” routes LocationIQ calls through server to hide API key
# For dev: http://localhost:3001 (run `node proxy-server.js`)
# For production: your deployed proxy URL
EXPO_PUBLIC_API_PROXY_URL=http://localhost:3001
# Optional development fallback: allow direct client->LocationIQ calls
# Keep false for production/public builds.
EXPO_PUBLIC_ALLOW_DIRECT_LOCATIONIQ=false
# Optional shared token for non-public/internal clients only.
# This is ignored in production app builds and should stay empty for public releases.
EXPO_PUBLIC_API_PROXY_TOKEN=

# Optional dedicated CORS proxy base used for GTFS web fetches.
# Accepts either a full ".../proxy?url=" value or a base URL ("/proxy?url=" will be appended).
EXPO_PUBLIC_CORS_PROXY_URL=http://localhost:3001/proxy?url=
# Optional shared token sent to private CORS proxy deployments (non-public builds only)
EXPO_PUBLIC_CORS_PROXY_TOKEN=

# Optional: allow public third-party CORS proxy fallbacks on web.
# Default false to avoid unreliable 403/rate-limit behavior.
EXPO_PUBLIC_ENABLE_PUBLIC_CORS_PROXIES=false

# App kill switch for auto-detected detours (set true to enable)
EXPO_PUBLIC_ENABLE_AUTO_DETOURS=false
# Enable detour geometry overlay on the map (skipped segment + inferred path)
EXPO_PUBLIC_ENABLE_DETOUR_GEOMETRY_UI=false

# Enable Transit On-Demand (TOD) zone overlays + trip planner integration
# Default ON (set to 'false' to disable)
EXPO_PUBLIC_ENABLE_TOD_ZONES=true

# Optional OpenTripPlanner backend URL for OTP fallback routing
# Example: https://your-otp.example.com/otp/routers/default
EXPO_PUBLIC_OTP_URL=

# Google Maps API Key
# Get your key from: https://console.cloud.google.com/google/maps-apis
EXPO_PUBLIC_GOOGLE_MAPS_API_KEY=YOUR_GOOGLE_MAPS_API_KEY_HERE

# Firebase Configuration
# Get these from: https://console.firebase.google.com/ > Project Settings > Your apps
EXPO_PUBLIC_FIREBASE_API_KEY=YOUR_FIREBASE_API_KEY
EXPO_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
EXPO_PUBLIC_FIREBASE_PROJECT_ID=your-project-id
EXPO_PUBLIC_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
EXPO_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=123456789
EXPO_PUBLIC_FIREBASE_APP_ID=1:123456789:web:abcdef
EXPO_PUBLIC_FIREBASE_MEASUREMENT_ID=G-XXXXXXXXXX

# Sentry Crash Reporting
# Get your DSN from: https://sentry.io > Project Settings > Client Keys (DSN)
EXPO_PUBLIC_SENTRY_DSN=https://your-dsn@sentry.io/your-project-id

# Optional path override used by app.config.js for Android Firebase file.
# In EAS, set GOOGLE_SERVICES_JSON as a file secret and this will be auto-resolved.
# GOOGLE_SERVICES_JSON=./google-services.json

# ===============================================
# Backend Detour Worker (api-proxy) Configuration
# ===============================================
# API auth hardening for proxy routes (/api/*)
REQUIRE_API_AUTH=true
# Browser origins allowed to call api-proxy (comma-separated)
# Example: https://app.example.com,https://www.app.example.com
ALLOWED_ORIGINS=http://localhost:8081,http://localhost:19006
# Use one token or multiple comma-separated tokens
# Keep ALLOW_SHARED_TOKEN_AUTH=false for internet-facing production services.
ALLOW_SHARED_TOKEN_AUTH=false
# API_PROXY_TOKEN=change-me
# API_PROXY_TOKENS=token1,token2
# Firebase ID token auth (recommended for production)
REQUIRE_FIREBASE_AUTH=true

# Enable server-side detour detection worker in api-proxy
DETOUR_WORKER_ENABLED=false
# Enable persistent detour history event logging in Firestore
DETOUR_HISTORY_ENABLED=true
# Retain detour history records for this many days (<=0 disables pruning)
DETOUR_HISTORY_RETENTION_DAYS=30

# Optional tuning (milliseconds / counts)
DETOUR_POLL_INTERVAL_MS=15000
DETOUR_STATIC_REFRESH_MS=21600000
DETOUR_EVIDENCE_WINDOW_MS=1800000
DETOUR_MIN_ROUTE_EVIDENCE=8
DETOUR_MIN_UNIQUE_VEHICLES=2
DETOUR_OFF_ROUTE_THRESHOLD_METERS=75
# Tighter threshold for clearing: vehicle must be within this distance to count as "on-route"
DETOUR_ON_ROUTE_CLEAR_THRESHOLD_METERS=40
# Minimum detour age (ms) before it can enter clear-pending state
DETOUR_CLEAR_GRACE_MS=600000
# Minimum detour age (ms) before clearing is considered at all
DETOUR_MIN_ACTIVE_MS=300000
# Consecutive on-route ticks required per vehicle before clearing
DETOUR_CLEAR_CONSECUTIVE_ON_ROUTE=6
# Geometry write throttle: minimum ms between Firestore geometry writes per route
DETOUR_GEOMETRY_WRITE_THROTTLE_MS=120000
# Server-only API key for ops debug endpoint access without Firebase token
# DETOUR_DEBUG_API_KEY=change-me

# Optional key for POST /api/detours/refresh
DETOUR_PROXY_KEY=change-me

# Firebase Admin credentials for api-proxy worker writes
# Option A: Inline JSON string
FIREBASE_SERVICE_ACCOUNT_JSON={"type":"service_account","project_id":"your-project-id","private_key_id":"...","private_key":"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\\n","client_email":"...","client_id":"...","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"..."}

# Option B: Path to service account file
# GOOGLE_APPLICATION_CREDENTIALS=C:\\path\\to\\service-account.json
